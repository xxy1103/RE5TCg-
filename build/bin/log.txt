[2025-06-20 09:39:41] [INFO] [main.c:25] 正在启动DNS代理服务器...
[2025-06-20 09:39:41] [DEBUG] [dnsServer.c:49] 初始化映射表 (id最大值为: 1000)
[2025-06-20 09:39:41] [DEBUG] [dnsServer.c:59] SOCKET 创建成功
[2025-06-20 09:39:41] [DEBUG] [dnsServer.c:67] 设置socket非阻塞成功
[2025-06-20 09:39:41] [INFO] [dnsServer.c:85] DNS服务成功运行，正在监听端口： 53...
[2025-06-20 09:39:41] [INFO] [dnsServer.c:86] 准备处理并发DNS请求（使用select()事件循环）
[2025-06-20 09:39:42] [DEBUG] [dnsServer.c:149] 服务器状态: 活跃映射数=0, 运行时间=10 秒
[2025-06-20 09:39:47] [DEBUG] [dnsServer.c:259] 收到来自 127.0.0.1:54388 的DNS请求 (40 字节)
[2025-06-20 09:39:47] [DEBUG] [dnsServer.c:264] === DNS Message ===
Transaction ID: 0x0001 (1)
Flags: 0x0100
  QR: 0 (Query)
  Opcode: 0
  AA: 0 (Authoritative Answer)
  TC: 0 (Truncated)
  RD: 1 (Recursion Desired)
  RA: 0 (Recursion Available)
  RCODE: 0

=== Counts ===
Questions: 1
Answers: 0
Authority Records: 0
Additional Records: 0

=== Questions ===
Question 1:
  Name: 1.0.0.127.in-addr.arpa
  Type: 12 (PTR)
  Class: 1 (IN)

=== End of DNS Message ===

[2025-06-20 09:39:47] [DEBUG] [dnsServer.c:265] 原始ID: 1
[2025-06-20 09:39:47] [DEBUG] [idmapping.c:56] 添加映射: 原始ID=1 -> 新ID=1 (槽位 0, 总数: 1)
[2025-06-20 09:39:47] [DEBUG] [dnsServer.c:290] 修改请求ID: 1 -> 1
[2025-06-20 09:39:47] [ERROR] [websocket.c:33] sendto 调用失败，错误码: 10051
[2025-06-20 09:39:47] [ERROR] [websocket.c:45] 向 10.3.9.6:53 发送数据失败，错误码: 10051
[2025-06-20 09:39:47] [ERROR] [dnsServer.c:294] 转发请求到上游服务器失败 (新ID=1)
[2025-06-20 09:39:47] [DEBUG] [idmapping.c:112] 移除映射: 新ID=1，槽位 0 (剩余: 0)
[2025-06-20 09:39:47] [DEBUG] [dnsServer.c:231] 本批次已处理 1 个客户端请求
[2025-06-20 09:39:49] [DEBUG] [dnsServer.c:259] 收到来自 127.0.0.1:54389 的DNS请求 (32 字节)
[2025-06-20 09:39:49] [DEBUG] [dnsServer.c:264] === DNS Message ===
Transaction ID: 0x0002 (2)
Flags: 0x0100
  QR: 0 (Query)
  Opcode: 0
  AA: 0 (Authoritative Answer)
  TC: 0 (Truncated)
  RD: 1 (Recursion Desired)
  RA: 0 (Recursion Available)
  RCODE: 0

=== Counts ===
Questions: 1
Answers: 0
Authority Records: 0
Additional Records: 0

=== Questions ===
Question 1:
  Name: www.google.com
  Type: 1 (A)
  Class: 1 (IN)

=== End of DNS Message ===

[2025-06-20 09:39:49] [DEBUG] [dnsServer.c:265] 原始ID: 2
[2025-06-20 09:39:49] [DEBUG] [idmapping.c:56] 添加映射: 原始ID=2 -> 新ID=2 (槽位 0, 总数: 1)
[2025-06-20 09:39:49] [DEBUG] [dnsServer.c:290] 修改请求ID: 2 -> 2
[2025-06-20 09:39:49] [ERROR] [websocket.c:33] sendto 调用失败，错误码: 10051
[2025-06-20 09:39:49] [ERROR] [websocket.c:45] 向 10.3.9.6:53 发送数据失败，错误码: 10051
[2025-06-20 09:39:49] [ERROR] [dnsServer.c:294] 转发请求到上游服务器失败 (新ID=2)
[2025-06-20 09:39:49] [DEBUG] [idmapping.c:112] 移除映射: 新ID=2，槽位 0 (剩余: 0)
[2025-06-20 09:39:49] [DEBUG] [dnsServer.c:231] 本批次已处理 1 个客户端请求
[2025-06-20 09:39:51] [DEBUG] [dnsServer.c:259] 收到来自 127.0.0.1:54390 的DNS请求 (32 字节)
[2025-06-20 09:39:51] [DEBUG] [dnsServer.c:264] === DNS Message ===
Transaction ID: 0x0003 (3)
Flags: 0x0100
  QR: 0 (Query)
  Opcode: 0
  AA: 0 (Authoritative Answer)
  TC: 0 (Truncated)
  RD: 1 (Recursion Desired)
  RA: 0 (Recursion Available)
  RCODE: 0

=== Counts ===
Questions: 1
Answers: 0
Authority Records: 0
Additional Records: 0

=== Questions ===
Question 1:
  Name: www.google.com
  Type: 28 (AAAA)
  Class: 1 (IN)

=== End of DNS Message ===

[2025-06-20 09:39:51] [DEBUG] [dnsServer.c:265] 原始ID: 3
[2025-06-20 09:39:51] [DEBUG] [idmapping.c:56] 添加映射: 原始ID=3 -> 新ID=3 (槽位 0, 总数: 1)
[2025-06-20 09:39:51] [DEBUG] [dnsServer.c:290] 修改请求ID: 3 -> 3
[2025-06-20 09:39:51] [ERROR] [websocket.c:33] sendto 调用失败，错误码: 10051
[2025-06-20 09:39:51] [ERROR] [websocket.c:45] 向 10.3.9.6:53 发送数据失败，错误码: 10051
[2025-06-20 09:39:51] [ERROR] [dnsServer.c:294] 转发请求到上游服务器失败 (新ID=3)
[2025-06-20 09:39:51] [DEBUG] [idmapping.c:112] 移除映射: 新ID=3，槽位 0 (剩余: 0)
[2025-06-20 09:39:51] [DEBUG] [dnsServer.c:231] 本批次已处理 1 个客户端请求
[2025-06-20 09:39:53] [DEBUG] [dnsServer.c:149] 服务器状态: 活跃映射数=0, 运行时间=10 秒
[2025-06-20 09:39:53] [DEBUG] [dnsServer.c:259] 收到来自 127.0.0.1:54391 的DNS请求 (32 字节)
[2025-06-20 09:39:53] [DEBUG] [dnsServer.c:264] === DNS Message ===
Transaction ID: 0x0004 (4)
Flags: 0x0100
  QR: 0 (Query)
  Opcode: 0
  AA: 0 (Authoritative Answer)
  TC: 0 (Truncated)
  RD: 1 (Recursion Desired)
  RA: 0 (Recursion Available)
  RCODE: 0

=== Counts ===
Questions: 1
Answers: 0
Authority Records: 0
Additional Records: 0

=== Questions ===
Question 1:
  Name: www.google.com
  Type: 1 (A)
  Class: 1 (IN)

=== End of DNS Message ===

[2025-06-20 09:39:53] [DEBUG] [dnsServer.c:265] 原始ID: 4
[2025-06-20 09:39:53] [DEBUG] [idmapping.c:56] 添加映射: 原始ID=4 -> 新ID=4 (槽位 0, 总数: 1)
[2025-06-20 09:39:53] [DEBUG] [dnsServer.c:290] 修改请求ID: 4 -> 4
[2025-06-20 09:39:53] [ERROR] [websocket.c:33] sendto 调用失败，错误码: 10051
[2025-06-20 09:39:53] [ERROR] [websocket.c:45] 向 10.3.9.6:53 发送数据失败，错误码: 10051
[2025-06-20 09:39:53] [ERROR] [dnsServer.c:294] 转发请求到上游服务器失败 (新ID=4)
[2025-06-20 09:39:53] [DEBUG] [idmapping.c:112] 移除映射: 新ID=4，槽位 0 (剩余: 0)
[2025-06-20 09:39:53] [DEBUG] [dnsServer.c:231] 本批次已处理 1 个客户端请求
[2025-06-20 09:39:55] [DEBUG] [dnsServer.c:259] 收到来自 127.0.0.1:57732 的DNS请求 (32 字节)
[2025-06-20 09:39:55] [DEBUG] [dnsServer.c:264] === DNS Message ===
Transaction ID: 0x0005 (5)
Flags: 0x0100
  QR: 0 (Query)
  Opcode: 0
  AA: 0 (Authoritative Answer)
  TC: 0 (Truncated)
  RD: 1 (Recursion Desired)
  RA: 0 (Recursion Available)
  RCODE: 0

=== Counts ===
Questions: 1
Answers: 0
Authority Records: 0
Additional Records: 0

=== Questions ===
Question 1:
  Name: www.google.com
  Type: 28 (AAAA)
  Class: 1 (IN)

=== End of DNS Message ===

[2025-06-20 09:39:55] [DEBUG] [dnsServer.c:265] 原始ID: 5
[2025-06-20 09:39:55] [DEBUG] [idmapping.c:56] 添加映射: 原始ID=5 -> 新ID=5 (槽位 0, 总数: 1)
[2025-06-20 09:39:55] [DEBUG] [dnsServer.c:290] 修改请求ID: 5 -> 5
[2025-06-20 09:39:55] [ERROR] [websocket.c:33] sendto 调用失败，错误码: 10051
[2025-06-20 09:39:55] [ERROR] [websocket.c:45] 向 10.3.9.6:53 发送数据失败，错误码: 10051
[2025-06-20 09:39:55] [ERROR] [dnsServer.c:294] 转发请求到上游服务器失败 (新ID=5)
[2025-06-20 09:39:55] [DEBUG] [idmapping.c:112] 移除映射: 新ID=5，槽位 0 (剩余: 0)
[2025-06-20 09:39:55] [DEBUG] [dnsServer.c:231] 本批次已处理 1 个客户端请求
[2025-06-20 09:40:04] [DEBUG] [dnsServer.c:149] 服务器状态: 活跃映射数=0, 运行时间=10 秒
[2025-06-20 09:40:15] [DEBUG] [dnsServer.c:149] 服务器状态: 活跃映射数=0, 运行时间=10 秒
[2025-06-20 09:40:26] [DEBUG] [dnsServer.c:149] 服务器状态: 活跃映射数=0, 运行时间=10 秒
[2025-06-20 09:40:37] [DEBUG] [dnsServer.c:149] 服务器状态: 活跃映射数=0, 运行时间=10 秒
[2025-06-20 09:40:48] [DEBUG] [dnsServer.c:149] 服务器状态: 活跃映射数=0, 运行时间=10 秒
