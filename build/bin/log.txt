[2025-06-20 12:42:58] [INFO] [main.c:25] 正在启动DNS代理服务器...
[2025-06-20 12:42:58] [DEBUG] [dnsServer.c:49] 初始化映射表 (id最大值为: 1000)
[2025-06-20 12:42:58] [DEBUG] [dnsServer.c:59] SOCKET 创建成功
[2025-06-20 12:42:58] [DEBUG] [dnsServer.c:67] 设置socket非阻塞成功
[2025-06-20 12:42:58] [INFO] [dnsServer.c:86] DNS服务成功运行，正在监听端口： 53...
[2025-06-20 12:42:58] [INFO] [dnsServer.c:87] 准备处理并发DNS请求（使用select()事件循环）
[2025-06-20 12:42:59] [DEBUG] [dnsServer.c:150] 服务器状态: 活跃映射数=0, 运行时间=10 秒
[2025-06-20 12:43:10] [DEBUG] [dnsServer.c:150] 服务器状态: 活跃映射数=0, 运行时间=10 秒
[2025-06-20 12:43:10] [DEBUG] [dnsServer.c:260] 收到来自 127.0.0.1:49204 的DNS请求 (40 字节)
[2025-06-20 12:43:10] [DEBUG] [dnsServer.c:265] === DNS Message ===
Transaction ID: 0x0001 (1)
Flags: 0x0100
  QR: 0 (Query)
  Opcode: 0
  AA: 0 (Authoritative Answer)
  TC: 0 (Truncated)
  RD: 1 (Recursion Desired)
  RA: 0 (Recursion Available)
  RCODE: 0

=== Counts ===
Questions: 1
Answers: 0
Authority Records: 0
Additional Records: 0

=== Questions ===
Question 1:
  Name: 1.0.0.127.in-addr.arpa
  Type: 12 (PTR)
  Class: 1 (IN)

=== End of DNS Message ===

[2025-06-20 12:43:10] [DEBUG] [dnsServer.c:266] 原始ID: 1
[2025-06-20 12:43:10] [DEBUG] [idmapping.c:56] 添加映射: 原始ID=1 -> 新ID=1 (槽位 0, 总数: 1)
[2025-06-20 12:43:10] [DEBUG] [dnsServer.c:291] 修改请求ID: 1 -> 1
[2025-06-20 12:43:10] [DEBUG] [dnsServer.c:299] 成功转发请求，上游ID=1
[2025-06-20 12:43:10] [DEBUG] [dnsServer.c:232] 本批次已处理 1 个客户端请求
[2025-06-20 12:43:10] [DEBUG] [dnsServer.c:334] 正在处理上游ID为 1 的响应
[2025-06-20 12:43:10] [DEBUG] [idmapping.c:82] 找到新ID=1 的映射，位于槽位 0
[2025-06-20 12:43:10] [DEBUG] [dnsServer.c:358] 恢复响应ID: 1 -> 1，目标客户端 127.0.0.1:49204
[2025-06-20 12:43:10] [INFO] [dnsServer.c:370] 已向客户端 127.0.0.1:49204 发送响应 (91 字节，原始ID=1)
[2025-06-20 12:43:10] [DEBUG] [idmapping.c:112] 移除映射: 新ID=1，槽位 0 (剩余: 0)
[2025-06-20 12:43:10] [DEBUG] [dnsServer.c:232] 本批次已处理 1 个客户端请求
[2025-06-20 12:43:10] [DEBUG] [dnsServer.c:260] 收到来自 127.0.0.1:49205 的DNS请求 (32 字节)
[2025-06-20 12:43:10] [DEBUG] [dnsServer.c:265] === DNS Message ===
Transaction ID: 0x0002 (2)
Flags: 0x0100
  QR: 0 (Query)
  Opcode: 0
  AA: 0 (Authoritative Answer)
  TC: 0 (Truncated)
  RD: 1 (Recursion Desired)
  RA: 0 (Recursion Available)
  RCODE: 0

=== Counts ===
Questions: 1
Answers: 0
Authority Records: 0
Additional Records: 0

=== Questions ===
Question 1:
  Name: www.google.com
  Type: 1 (A)
  Class: 1 (IN)

=== End of DNS Message ===

[2025-06-20 12:43:10] [DEBUG] [dnsServer.c:266] 原始ID: 2
[2025-06-20 12:43:10] [DEBUG] [idmapping.c:56] 添加映射: 原始ID=2 -> 新ID=2 (槽位 0, 总数: 1)
[2025-06-20 12:43:10] [DEBUG] [dnsServer.c:291] 修改请求ID: 2 -> 2
[2025-06-20 12:43:10] [DEBUG] [dnsServer.c:299] 成功转发请求，上游ID=2
[2025-06-20 12:43:10] [DEBUG] [dnsServer.c:232] 本批次已处理 1 个客户端请求
[2025-06-20 12:43:10] [DEBUG] [dnsServer.c:334] 正在处理上游ID为 2 的响应
[2025-06-20 12:43:10] [DEBUG] [idmapping.c:82] 找到新ID=2 的映射，位于槽位 0
[2025-06-20 12:43:10] [DEBUG] [dnsServer.c:358] 恢复响应ID: 2 -> 2，目标客户端 127.0.0.1:49205
[2025-06-20 12:43:10] [INFO] [dnsServer.c:370] 已向客户端 127.0.0.1:49205 发送响应 (48 字节，原始ID=2)
[2025-06-20 12:43:10] [DEBUG] [idmapping.c:112] 移除映射: 新ID=2，槽位 0 (剩余: 0)
[2025-06-20 12:43:10] [DEBUG] [dnsServer.c:232] 本批次已处理 1 个客户端请求
[2025-06-20 12:43:10] [DEBUG] [dnsServer.c:260] 收到来自 127.0.0.1:49206 的DNS请求 (32 字节)
[2025-06-20 12:43:10] [DEBUG] [dnsServer.c:265] === DNS Message ===
Transaction ID: 0x0003 (3)
Flags: 0x0100
  QR: 0 (Query)
  Opcode: 0
  AA: 0 (Authoritative Answer)
  TC: 0 (Truncated)
  RD: 1 (Recursion Desired)
  RA: 0 (Recursion Available)
  RCODE: 0

=== Counts ===
Questions: 1
Answers: 0
Authority Records: 0
Additional Records: 0

=== Questions ===
Question 1:
  Name: www.google.com
  Type: 28 (AAAA)
  Class: 1 (IN)

=== End of DNS Message ===

[2025-06-20 12:43:10] [DEBUG] [dnsServer.c:266] 原始ID: 3
[2025-06-20 12:43:10] [DEBUG] [idmapping.c:56] 添加映射: 原始ID=3 -> 新ID=3 (槽位 0, 总数: 1)
[2025-06-20 12:43:10] [DEBUG] [dnsServer.c:291] 修改请求ID: 3 -> 3
[2025-06-20 12:43:10] [DEBUG] [dnsServer.c:299] 成功转发请求，上游ID=3
[2025-06-20 12:43:10] [DEBUG] [dnsServer.c:232] 本批次已处理 1 个客户端请求
[2025-06-20 12:43:10] [DEBUG] [dnsServer.c:334] 正在处理上游ID为 3 的响应
[2025-06-20 12:43:10] [DEBUG] [idmapping.c:82] 找到新ID=3 的映射，位于槽位 0
[2025-06-20 12:43:10] [DEBUG] [dnsServer.c:358] 恢复响应ID: 3 -> 3，目标客户端 127.0.0.1:49206
[2025-06-20 12:43:10] [INFO] [dnsServer.c:370] 已向客户端 127.0.0.1:49206 发送响应 (60 字节，原始ID=3)
[2025-06-20 12:43:10] [DEBUG] [idmapping.c:112] 移除映射: 新ID=3，槽位 0 (剩余: 0)
[2025-06-20 12:43:10] [DEBUG] [dnsServer.c:232] 本批次已处理 1 个客户端请求
[2025-06-20 12:43:21] [DEBUG] [dnsServer.c:150] 服务器状态: 活跃映射数=0, 运行时间=10 秒
[2025-06-20 12:43:21] [DEBUG] [dnsServer.c:260] 收到来自 127.0.0.1:59368 的DNS请求 (40 字节)
[2025-06-20 12:43:21] [DEBUG] [dnsServer.c:265] === DNS Message ===
Transaction ID: 0x0001 (1)
Flags: 0x0100
  QR: 0 (Query)
  Opcode: 0
  AA: 0 (Authoritative Answer)
  TC: 0 (Truncated)
  RD: 1 (Recursion Desired)
  RA: 0 (Recursion Available)
  RCODE: 0

=== Counts ===
Questions: 1
Answers: 0
Authority Records: 0
Additional Records: 0

=== Questions ===
Question 1:
  Name: 1.0.0.127.in-addr.arpa
  Type: 12 (PTR)
  Class: 1 (IN)

=== End of DNS Message ===

[2025-06-20 12:43:21] [DEBUG] [dnsServer.c:266] 原始ID: 1
[2025-06-20 12:43:21] [DEBUG] [idmapping.c:56] 添加映射: 原始ID=1 -> 新ID=4 (槽位 0, 总数: 1)
[2025-06-20 12:43:21] [DEBUG] [dnsServer.c:291] 修改请求ID: 1 -> 4
[2025-06-20 12:43:21] [DEBUG] [dnsServer.c:299] 成功转发请求，上游ID=4
[2025-06-20 12:43:21] [DEBUG] [dnsServer.c:232] 本批次已处理 1 个客户端请求
[2025-06-20 12:43:21] [DEBUG] [dnsServer.c:334] 正在处理上游ID为 4 的响应
[2025-06-20 12:43:21] [DEBUG] [idmapping.c:82] 找到新ID=4 的映射，位于槽位 0
[2025-06-20 12:43:21] [DEBUG] [dnsServer.c:358] 恢复响应ID: 4 -> 1，目标客户端 127.0.0.1:59368
[2025-06-20 12:43:21] [INFO] [dnsServer.c:370] 已向客户端 127.0.0.1:59368 发送响应 (91 字节，原始ID=1)
[2025-06-20 12:43:21] [DEBUG] [idmapping.c:112] 移除映射: 新ID=4，槽位 0 (剩余: 0)
[2025-06-20 12:43:21] [DEBUG] [dnsServer.c:232] 本批次已处理 1 个客户端请求
[2025-06-20 12:43:21] [DEBUG] [dnsServer.c:260] 收到来自 127.0.0.1:59369 的DNS请求 (34 字节)
[2025-06-20 12:43:21] [DEBUG] [dnsServer.c:265] === DNS Message ===
Transaction ID: 0x0002 (2)
Flags: 0x0100
  QR: 0 (Query)
  Opcode: 0
  AA: 0 (Authoritative Answer)
  TC: 0 (Truncated)
  RD: 1 (Recursion Desired)
  RA: 0 (Recursion Available)
  RCODE: 0

=== Counts ===
Questions: 1
Answers: 0
Authority Records: 0
Additional Records: 0

=== Questions ===
Question 1:
  Name: blog.ulna520.top
  Type: 1 (A)
  Class: 1 (IN)

=== End of DNS Message ===

[2025-06-20 12:43:21] [DEBUG] [dnsServer.c:266] 原始ID: 2
[2025-06-20 12:43:21] [DEBUG] [idmapping.c:56] 添加映射: 原始ID=2 -> 新ID=5 (槽位 0, 总数: 1)
[2025-06-20 12:43:21] [DEBUG] [dnsServer.c:291] 修改请求ID: 2 -> 5
[2025-06-20 12:43:21] [DEBUG] [dnsServer.c:299] 成功转发请求，上游ID=5
[2025-06-20 12:43:21] [DEBUG] [dnsServer.c:232] 本批次已处理 1 个客户端请求
[2025-06-20 12:43:21] [DEBUG] [dnsServer.c:334] 正在处理上游ID为 5 的响应
[2025-06-20 12:43:21] [DEBUG] [idmapping.c:82] 找到新ID=5 的映射，位于槽位 0
[2025-06-20 12:43:21] [DEBUG] [dnsServer.c:358] 恢复响应ID: 5 -> 2，目标客户端 127.0.0.1:59369
[2025-06-20 12:43:21] [INFO] [dnsServer.c:370] 已向客户端 127.0.0.1:59369 发送响应 (66 字节，原始ID=2)
[2025-06-20 12:43:21] [DEBUG] [idmapping.c:112] 移除映射: 新ID=5，槽位 0 (剩余: 0)
[2025-06-20 12:43:21] [DEBUG] [dnsServer.c:232] 本批次已处理 1 个客户端请求
[2025-06-20 12:43:21] [DEBUG] [dnsServer.c:260] 收到来自 127.0.0.1:59370 的DNS请求 (34 字节)
[2025-06-20 12:43:21] [DEBUG] [dnsServer.c:265] === DNS Message ===
Transaction ID: 0x0003 (3)
Flags: 0x0100
  QR: 0 (Query)
  Opcode: 0
  AA: 0 (Authoritative Answer)
  TC: 0 (Truncated)
  RD: 1 (Recursion Desired)
  RA: 0 (Recursion Available)
  RCODE: 0

=== Counts ===
Questions: 1
Answers: 0
Authority Records: 0
Additional Records: 0

=== Questions ===
Question 1:
  Name: blog.ulna520.top
  Type: 28 (AAAA)
  Class: 1 (IN)

=== End of DNS Message ===

[2025-06-20 12:43:21] [DEBUG] [dnsServer.c:266] 原始ID: 3
[2025-06-20 12:43:21] [DEBUG] [idmapping.c:56] 添加映射: 原始ID=3 -> 新ID=6 (槽位 0, 总数: 1)
[2025-06-20 12:43:21] [DEBUG] [dnsServer.c:291] 修改请求ID: 3 -> 6
[2025-06-20 12:43:21] [DEBUG] [dnsServer.c:299] 成功转发请求，上游ID=6
[2025-06-20 12:43:21] [DEBUG] [dnsServer.c:232] 本批次已处理 1 个客户端请求
[2025-06-20 12:43:21] [DEBUG] [dnsServer.c:334] 正在处理上游ID为 6 的响应
[2025-06-20 12:43:21] [DEBUG] [idmapping.c:82] 找到新ID=6 的映射，位于槽位 0
[2025-06-20 12:43:21] [DEBUG] [dnsServer.c:358] 恢复响应ID: 6 -> 3，目标客户端 127.0.0.1:59370
[2025-06-20 12:43:21] [INFO] [dnsServer.c:370] 已向客户端 127.0.0.1:59370 发送响应 (90 字节，原始ID=3)
[2025-06-20 12:43:21] [DEBUG] [idmapping.c:112] 移除映射: 新ID=6，槽位 0 (剩余: 0)
[2025-06-20 12:43:21] [DEBUG] [dnsServer.c:232] 本批次已处理 1 个客户端请求
